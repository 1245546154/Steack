Heartbeat高可用：TCP/UDP的694号端口

Heartbeat，心跳的意思，这里是Linux-HA 工程的一个组成部分，它实现了一个高可用集群系统。

心跳服务和集群通信是高可用集群的两个关键组件，在 Heartbeat 项目里，由 heartbeat 模块实现了这两个功能。


heartbeat最核心的包括两个部分――（心跳监测部分）和（资源接管部分）

心跳监测可以通过网络链路和串口进行，而且支持冗余链路，它们之间相互发送报文来告诉对方自己当前的状态，如果在指定的时间内未收到对方发送的报文，那么就认为对方失效。
这时需启动资源接管模块来接管运行在对方主机上的资源或者服务。


――――――――――――――――――――――――――――――――――――――――――――――――――――――――


Hearbeat和keepalived区别：
###
Keepalived使用的vrrp协议方式
Heartbeat是基于主机或网络的服务的高可用方式

###
keepalived的目的是模拟路由器的双机
heartbeat的目的是用户service的双机

###
lvs 的高可用建议用keepavlived
业务的高可用用heartbeat


――――――――――――――――――――――――――――――――――――――――――――――――――――――――

Heartbeat的主备工作原理：类似于主从的一种工作原理（热备服务器使用心跳检测侦测主服务器）

可以修改Hearbeat的配置文件，可以指定哪台Hearbeat的服务器做主要服务器，另一台自动成为热备服务器。
##然后在热备服务器上配置Heartbeat守护程序来监听来自主服务器的心跳消息。##

如果热备服务器在指定的时间内未监听到来自主服务器的心跳，就会启动故障转移程序，并取得主服务器上的相关资源服务的所有权，接替主服务器继续不间断的提供服务，从而达到资源及服务高可用性的目的。


###############################################################


Heartbeat的主主工作原理：类似于双主的一种工作原理（互相发送报文来侦测状态）

即两台服务器互为主备，这时它们之间会相互发送报文来告诉对方自己当前的状态。
如果在指定的时间内未收到对方发送的心跳报文，那么，一方就会认为对方失效或者宕机了。
这每个运行正常的主机就会启动自身的“资源接管模块”来接管运行在对方主机上的资源或者服务，继续为用户提供服务。



注：停止数据库及存储服务等>heartbeat的主备高可用的切换时间一般是在5-20秒左右



Hearbeat脑裂：（基本都是中间的线路故障，双方无法进行报文通讯）

心跳线断了，无法通讯
使用网路直连时，网卡驱动坏了，局域网IP冲突
心跳线之间的中转设备坏了
iptables
地址信息不对
网线误拔





