负载均衡服务器的高可用性：一句话使用平均无故障时间来度量
HA高可用  LB负载均衡  SA可伸缩性  MG可管理性  CE价格有效性


并不是一开始就需要负载均衡，当网络应用的访问量不断增长，单个处理节点无法满足负载需求时，网络应用流量将要出现瓶颈时，负载均衡才会起到作用。


常用的负载均衡软件：haproxy、nginx和lvs
可伸缩网络服务的共同特点：它们都需要一个前端的负载调度器（或者多个进行主从备份）


伸缩性：
当整个系统受到的负载超过目前所有结点的处理能力时，可以在服务器池中增加服务器来满足不断增长的请求负载。


7层负载均衡，是用来实现对于前段集群的一个减缓压力方案，用于优化资源利用率，增大吞吐量，减少延迟并提高容错率。
使用nginx的负载均衡用来减轻web服务器的压力，负载均衡可以用来将请求分发到不同的服务器，使流量平均的分配。
当出现故障的时候能做到继续提供服务支持，不至于直接down掉影响正常的业务，大大提高容错率。
从而提升整体集群架构的高可用性。


4层负载均衡，是实现用来对于后端集群的一个减缓压力方案，用于优化资源利用率，增大吞吐量，减少延迟并提高容错率。
当访问量增大时，同时对于后端数据库的压力也随之增大的同时，出错率就会增加。
使用负载均衡用来减缓后端的压力，同时提高数据的访问速度。
出现故障的时候同样可以做到，继续提供服务支持，不至于直接down掉影响正常的业务，大大提高容错率。
从而提升整体集群架构的高可用性。


缓存的作用：提高访问速度，缓解对于架构的数据流量访问。
1.减少访冗余内容传输
2.节省带宽，缓解网络瓶颈
3.降低了对原始服务器的请求压力
4.降低了传输延迟


――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――

keepalived：实现的功能
自动侦测：心跳检测
自动切换：故障发生之后的自动切换（故障切换）
自动恢复：故障排除之后的自动恢复

## ##

HAproxy：支持1W次以上的同时连接的4层7层负载均衡器，其提供高可用性、负载均衡，以及基于TCP和HTTP的应用程序代理。

HAproxy特别适用于那些负载特大的web站点，这些站点通常又需要会话保持或七层处理，支持万计的并发连接，支持虚拟机，结合监控软件（Zabbix和Nagios）可以做报警，稳定性也是非常好可以跟硬件级别的F5平分秋色。

并且它的运行模式使得它可以很简单安全的整合进您当前的架构中，同时可以保护你的web服务器不被暴露到网络上。

## ##


haproxy+keepalived 可以实现高可用集群得搭建，提高多服务器的性能，并且提高整体的高可用性。


代理服务器：可以提供缓存功能加速客户端访问，同时可以对缓存数据进行有效性检查

内容路由：根据流量以及内容类型将请求转发至特定的服务器（支持基于cookie进行调度）

转码器：支持压缩功能，将数据以压缩形式发送给客户端（GZIP）

故障切换：支持所有主服务器故障切换至备用服务器

集群监控：支持专用端口实现监控服务

负载均衡：可平衡负载至后端服务器，并支持持久连接

反向代理：支持http，支持动态程序，支持基于数据库

――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
章文嵩博士
LVS：（linux虚拟化服务器） 3种工作方式8种调度算法

LVS集群架构的优点：
1.性能：通过一组服务器分而治之，可以获得很高的整体性能。
2.性能/价格比：价格低，具有最高的性能/价格比
3.可伸缩性：集群系统中的结点数目可以增长到几千个，其伸缩性远超过单台超级计算机（但注意负载均衡器的压力大量的节点就需要使用到路由器/三层交换的OSPF技术）
4.高可用性：在硬件和软件上都有冗余，通过检测软硬件的故障，将故障屏蔽，由存活结点提供服务，可实现高可用性。
5.管理性：方便和易维护的管理性。

# #

IPVS：IP负载均衡中包括以下三种技术
VS/NAT：通过网络地址转换，将一组服务器构成一个高性能的虚拟服务器
VS/TUN：通过IP隧道实现虚拟服务器
VS/DR：通过直接路由实现虚拟服务器

# #

在设计时需要考虑系统的透明性、可伸缩性、高可用性和易管理性。

集群采用三层结构：
服务器池：所有真实的服务器机群划分为一个整体。
负载调度器：提供给用户进行访问的虚拟IP地址，原理与VRRP一样
共享存储：它为服务器池提供一个共享的存储区，所有服务器拥有相同的内容，可以相同的服务。


当整个系统受到的负载超过目前所有结点的处理能力时，可以在服务器池中增加服务器来满足不断增长的请求负载。

缺点：
1.功能比较简单，支持复杂应用的负载均衡能力较差，如算法较少等；
2.开启隧道方式需重编译内核；
3.配置复杂；
4.无法适用与windows平台
5.扩展性有限


LVS+keepalived的基础之上升级的架构为LVS+OSPF（把linux插入到OSPF的路由表里去）

ECMP（等价多路径）：而等值多路径路由协议可以在该网络环境下同时使用多条链路

WCMP（加权多路径）：能够非常灵活地按照比例在链路上传递流量。


――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――

F5负载均衡：硬件化设备提供的负载均衡。

流量负载均衡
链路负载均衡
本地流量负载均衡



